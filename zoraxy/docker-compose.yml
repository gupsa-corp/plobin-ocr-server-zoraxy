version: '3.8'

services:
  zoraxy:
    image: zoraxydocker/zoraxy:latest
    restart: unless-stopped
    ports:
      - "80:80"       # HTTP
      - "443:443"     # HTTPS
      - "${EXTERNAL_PORT:-10001}:8000"  # Web管理界面
    volumes:
      - ./config:/opt/zoraxy/config
      - ./certs:/opt/zoraxy/certs
      - /var/run/docker.sock:/var/run/docker.sock:ro  # Docker 소켓 접근
    environment:
      - ZORAXY_CONFIG_PATH=/opt/zoraxy/config
      - ZORAXY_CERT_PATH=/opt/zoraxy/certs
    command: [
      "-port=10001",
      "-noauth=${NO_AUTH:-false}",
      "-docker",
      "-webroot=/opt/zoraxy/www",
      "-config=/opt/zoraxy/config",
      "-disable-tls"
    ]